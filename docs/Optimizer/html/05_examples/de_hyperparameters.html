

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tuning differential evolution hyperparameters &mdash; optimizer 1.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="../_static/copybutton.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/qb1-sphinx-rtd.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme-overrides.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/optimizer.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="optimizer" href="../06_optimizer_api/modules.html" />
    <link rel="prev" title="Warm start" href="warm_start.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> optimizer
          

          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/01_introduction.html">What is Optimizer?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/01_introduction.html#using-optimizer">Using Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/01_introduction.html#is-optimizer-right-for-my-problem">Is Optimizer right for my problem?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/01_introduction.html#assumptions">Assumptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/01_introduction.html#faq">FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_getting_started/01_prerequisites.html">Installation prerequisites</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_getting_started/01_prerequisites.html#python-virtual-environments">Python virtual environments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../02_getting_started/01_prerequisites.html#using-conda">Using <code class="docutils literal notranslate"><span class="pre">conda</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../02_getting_started/01_prerequisites.html#installing-requirements">Installing requirements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../02_getting_started/02_install.html">Installation guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_tutorial/01_solver_api.html">Solver API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/01_solver_api.html#ask-and-tell-pattern">Ask and Tell pattern</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../03_tutorial/01_solver_api.html#standard-solve-pattern">Standard solve pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../03_tutorial/01_solver_api.html#solving-with-ask-and-tell">Solving with Ask and Tell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/01_solver_api.html#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../03_tutorial/02_toy_problem.html">Toy problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/02_toy_problem.html#The-Solver">The Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../03_tutorial/02_toy_problem.html#ask-method"><code class="docutils literal notranslate"><span class="pre">ask</span></code> method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/02_toy_problem.html#Evaluating">Evaluating</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../03_tutorial/02_toy_problem.html#tell-method"><code class="docutils literal notranslate"><span class="pre">tell</span></code> method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/02_toy_problem.html#Solver-loop">Solver loop</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../03_tutorial/03_constraints.html">Constraints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/03_constraints.html#Constraints-as-penalty-functions">Constraints as penalty functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/03_constraints.html#Constraints-as-repair-functions">Constraints as repair functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/03_constraints.html#Warning-about-pickling-constraints">Warning about pickling constraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../03_tutorial/04_optimization_problem.html">Optimization problem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/04_optimization_problem.html#Maximizing-a-problem">Maximizing a problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_tutorial/04_optimization_problem.html#The-StatefulOptimizationProblem">The <code class="docutils literal notranslate"><span class="pre">StatefulOptimizationProblem</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../03_tutorial/04_optimization_problem.html#StatefulOptimizationProblem-with-Numpy"><code class="docutils literal notranslate"><span class="pre">StatefulOptimizationProblem</span></code> with <code class="docutils literal notranslate"><span class="pre">Numpy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../03_tutorial/04_optimization_problem.html#StatefulOptimizationProblem-with-Pandas"><code class="docutils literal notranslate"><span class="pre">StatefulOptimizationProblem</span></code> with <code class="docutils literal notranslate"><span class="pre">Pandas</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/01_penalty.html">Penalty</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Constraint-types">Constraint types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Equality-constraints">Equality constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Model-based-constraints">Model-based constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Dealing-with-a-computationally-expensive-constraint">Dealing with a computationally expensive constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Penalty-options">Penalty options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Changing-the-penalty-multiplier-(\lambda)">Changing the penalty multiplier (<span class="math notranslate nohighlight">\(\lambda\)</span>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/01_penalty.html#Set-based-constraints">Set-based constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/01_penalty.html#A-comment-on-set-constraints:">A comment on set constraints:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/02_repair.html">Repair</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/02_repair.html#MultipleOf-and-Integer-constraints"><code class="docutils literal notranslate"><span class="pre">MultipleOf</span></code> and <code class="docutils literal notranslate"><span class="pre">Integer</span></code> constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/02_repair.html#User-defined-set-constraints">User defined set constraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/03_solver.html">Solver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#basesolver"><code class="docutils literal notranslate"><span class="pre">BaseSolver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#scaledsolver"><code class="docutils literal notranslate"><span class="pre">ScaledSolver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#differentialevolutionsolver"><code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#evolutionarystrategiessolver"><code class="docutils literal notranslate"><span class="pre">EvolutionaryStrategiesSolver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#particleswarmsolver"><code class="docutils literal notranslate"><span class="pre">ParticleSwarmSolver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#simulatedannealingsolver"><code class="docutils literal notranslate"><span class="pre">SimulatedAnnealingSolver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/03_solver.html#discretelocalsearchsolver"><code class="docutils literal notranslate"><span class="pre">DiscreteLocalSearchSolver</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/04_stopper.html">Stoppers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/04_stopper.html#noimprovementstopper"><code class="docutils literal notranslate"><span class="pre">NoImprovementStopper</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/04_stopper.html#walltimestopper"><code class="docutils literal notranslate"><span class="pre">WallTimeStopper</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/04_stopper.html#satisfiedconstraintstopper"><code class="docutils literal notranslate"><span class="pre">SatisfiedConstraintStopper</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/05_logger.html">Logger</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/05_logger.html#basiclogger"><code class="docutils literal notranslate"><span class="pre">BasicLogger</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/05_logger.html#penaltylogger"><code class="docutils literal notranslate"><span class="pre">PenaltyLogger</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/05_logger.html#nbestlogger"><code class="docutils literal notranslate"><span class="pre">NBestLogger</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/05_logger.html#file-based-logging">File-Based Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/06_plotting.html">Plotting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/06_plotting.html#Convergence-plot">Convergence plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/06_plotting.html#Penalty-plot">Penalty plot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/07_diagnostic.html">Optimization diagnostic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#What-this-is">What this is</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#What-this-is-not">What this is not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#The-optimization-model">The optimization model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#The-diagnostic">The diagnostic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Violated-soft-constraints">Violated soft constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Changing-the-inequality-bound">Changing the inequality bound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Impact-we-can-achieve-on-objective-value-by-changing-inequality">Impact we can achieve on objective value by changing inequality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Extrapolation-pitfall">Extrapolation pitfall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Complex-problem-support">Complex problem support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/07_diagnostic.html#Conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/08_history_penalty.html">Historical penalties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#Overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#What-this-is">What this is</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#What-this-is-not">What this is not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#The-historical-data-and-the-optimization-problem">The historical data and the optimization problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#Using-the-historical-penalty">Using the historical penalty</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#Validating-that-history-is-constraining-our-solutions">Validating that history is constraining our solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#Choosing-the-multiplier">Choosing the multiplier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#Pandas-support">Pandas support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/08_history_penalty.html#Pipeline-support">Pipeline support</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html">Adaptive Differential Evolution example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Vanilla-DE-logic">Vanilla DE logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#What-can-we-define-and-tune?">What can we define and tune?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Adaptive-Differential-Evolution">Adaptive Differential Evolution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Some-setup">Some setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Sample-run-of-two-approaches">Sample run of two approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Picking-mutator-based-on-prior-success">Picking mutator based on prior success</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Using-an-adaptive-parameter">Using an adaptive parameter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04_user_guide/09_adaptive_differential_evolution.html#Happy-hacking!">Happy hacking!</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="warm_start.html">Warm start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="warm_start.html#Problem-setup">Problem setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="warm_start.html#Warm-starting-ParticleSwarmSolver">Warm starting <code class="docutils literal notranslate"><span class="pre">ParticleSwarmSolver</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tuning differential evolution hyperparameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Effect-of-strategy">Effect of <code class="docutils literal notranslate"><span class="pre">strategy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Effect-of-popsize">Effect of <code class="docutils literal notranslate"><span class="pre">popsize</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Effect-of-mutation">Effect of <code class="docutils literal notranslate"><span class="pre">mutation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#Effect-of-recombination">Effect of <code class="docutils literal notranslate"><span class="pre">recombination</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_optimizer_api/modules.html">optimizer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../06_optimizer_api/optimizer.html">optimizer package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../06_optimizer_api/optimizer.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.constraint.html">optimizer.constraint package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.experimental.html">optimizer.experimental package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.loggers.html">optimizer.loggers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.plotting.html">optimizer.plotting package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.problem.html">optimizer.problem package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.solvers.html">optimizer.solvers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.stoppers.html">optimizer.stoppers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.testing.html">optimizer.testing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../06_optimizer_api/optimizer.utils.html">optimizer.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../06_optimizer_api/optimizer.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06_optimizer_api/optimizer.html#module-optimizer.exceptions">optimizer.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06_optimizer_api/optimizer.html#module-optimizer.types">optimizer.types module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">optimizer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          








    



    
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Tuning differential evolution hyperparameters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <!-- User defined GitHub URL -->
              <a href="https://git.mckinsey-solutions.com/opm/optimus" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tuning-differential-evolution-hyperparameters">
<h1>Tuning differential evolution hyperparameters<a class="headerlink" href="#Tuning-differential-evolution-hyperparameters" title="Permalink to this headline">¶</a></h1>
<p>Similar to most machine learning models, the hyperparameters that work best for any particular solver will differ based on the problem at hand. This notebook illustrates the effect each hyperparameter of the differential evolution (DE) solver has on the convergence of a search. Much research has been done on tuning these parameters, however there is no agreed upon solution to choosing a value for every problem.</p>
<p>For an overview of the main hyperparameters in DE, refer to the <a class="reference internal" href="../04_user_guide/03_solver.html"><span class="doc">solver user guide</span></a>.</p>
<p>The recommended ranges and some intuition around hyperparameters was borrowed from <a class="reference external" href="https://www.researchgate.net/publication/220380793">this survey</a> on the DE state of the art.</p>
<div class="section" id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Permalink to this headline">¶</a></h2>
<p>We’ll be solving the <a class="reference external" href="https://en.wikipedia.org/wiki/Ackley_function">Ackley function</a> in five dimensions. This function has its optimum at <span class="math notranslate nohighlight">\(\mathbf{x}^* = [0, 0, 0, 0, 0]\)</span> with <span class="math notranslate nohighlight">\(f(\mathbf{x}^*) = 0\)</span>. To save some code, we’ll set up a <code class="docutils literal notranslate"><span class="pre">solve</span></code> and <code class="docutils literal notranslate"><span class="pre">plot</span></code> function to visualize our searches over multiple seeds.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">optimizer.testing.problems</span> <span class="kn">import</span> <span class="n">Ackley</span>
<span class="kn">from</span> <span class="nn">optimizer.solvers</span> <span class="kn">import</span> <span class="n">DifferentialEvolutionSolver</span>

<span class="n">dimension</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ackley</span> <span class="o">=</span> <span class="n">Ackley</span><span class="p">()</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="n">ackley</span><span class="o">.</span><span class="n">bounds</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">solve</span><span class="p">(</span>
    <span class="n">strategy_</span><span class="o">=</span><span class="s2">&quot;best1bin&quot;</span><span class="p">,</span>
    <span class="n">popsize_</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span>
    <span class="n">mutation_</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
    <span class="n">recombination_</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">runs</span><span class="o">=</span><span class="mi">30</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Default arguments here are defaults in `DifferentialEvolutionSolver`. &quot;&quot;&quot;</span>
    <span class="n">best_objectives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">runs</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">))</span>
    <span class="n">population_variances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">runs</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span>
        <span class="n">solver</span> <span class="o">=</span> <span class="n">DifferentialEvolutionSolver</span><span class="p">(</span>
            <span class="n">bounds</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
            <span class="n">strategy</span><span class="o">=</span><span class="n">strategy_</span><span class="p">,</span>
            <span class="n">popsize</span><span class="o">=</span><span class="n">popsize_</span><span class="p">,</span>
            <span class="n">mutation</span><span class="o">=</span><span class="n">mutation_</span><span class="p">,</span>
            <span class="n">recombination</span><span class="o">=</span><span class="n">recombination_</span><span class="p">,</span>
            <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="p">)</span>

        <span class="n">bests</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">variances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">solver</span><span class="o">.</span><span class="n">stop</span><span class="p">():</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>
            <span class="n">f_x</span> <span class="o">=</span> <span class="n">ackley</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">solver</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_x</span><span class="p">)</span>

            <span class="n">bests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">best</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">variances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">parameters</span><span class="p">))</span>

        <span class="n">best_objectives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bests</span>
        <span class="n">population_variances</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">variances</span>

    <span class="k">return</span> <span class="n">best_objectives</span><span class="p">,</span> <span class="n">population_variances</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">bests_</span><span class="p">,</span> <span class="n">variances_</span><span class="p">,</span> <span class="n">labels_</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">best_</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">label_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bests_</span><span class="p">,</span> <span class="n">variances_</span><span class="p">,</span> <span class="n">labels_</span><span class="p">):</span>
        <span class="n">stdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vars_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">mean_best</span> <span class="o">=</span> <span class="n">best_</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_best</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">best_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mean_best</span> <span class="o">-</span> <span class="n">stdev</span><span class="p">,</span> <span class="n">mean_best</span> <span class="o">+</span> <span class="n">stdev</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stdev</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Best Objective Value&quot;</span><span class="p">),</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Population Standard Deviation&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(),</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Effect-of-strategy">
<h2>Effect of <code class="docutils literal notranslate"><span class="pre">strategy</span></code><a class="headerlink" href="#Effect-of-strategy" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">strategy</span></code> argument controls the mutation strategy used to generate new solutions. The community characterizes different strategies with a 3-part naming scheme of the form <code class="docutils literal notranslate"><span class="pre">x/y/z</span></code>. - <code class="docutils literal notranslate"><span class="pre">x</span></code>: the base vector being changed. - <code class="docutils literal notranslate"><span class="pre">y</span></code>: the number of difference vectors used to change <code class="docutils literal notranslate"><span class="pre">x</span></code>. - <code class="docutils literal notranslate"><span class="pre">z</span></code>: set to <code class="docutils literal notranslate"><span class="pre">bin</span></code> or <code class="docutils literal notranslate"><span class="pre">exp</span></code> to denote binomial or exponential crossover. Binomial crossover is most common and successful.</p>
<p>The default choice for <code class="docutils literal notranslate"><span class="pre">strategy</span></code> in <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code> is <code class="docutils literal notranslate"><span class="pre">best/1/bin</span></code> as this has been shown to be effective on a wide variety of problems. In general if you know your problem if unimodal, using a strategy that involves perturbing the current best in the population is a good idea. If the problem is multi-modal a strategy like <code class="docutils literal notranslate"><span class="pre">rand/1/bin</span></code> may be more appropriate to maintain population diversity. Population diversity refers to how different the solutions in the current
population are. We can simply measure this with the standard deviation of the population.</p>
<p>The choice of strategy is unique to DE and so we simply recommend the user to try <code class="docutils literal notranslate"><span class="pre">best/1/bin</span></code> or <code class="docutils literal notranslate"><span class="pre">rand/1/bin</span></code> on their problem as a good starting point. The formula for these rules are:</p>
<p><code class="docutils literal notranslate"><span class="pre">rand/1/bin</span></code>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{v}_{i} = \mathbf{x}_a + F * (\mathbf{x}_b - \mathbf{x}_c)\]</div>
<p>Where <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> is referred to as a mutant for population index <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(a\neq b \neq c \neq i\)</span> are random indices in the population, and <span class="math notranslate nohighlight">\(F\)</span> is the mutation factor (referred to as <code class="docutils literal notranslate"><span class="pre">mutation</span></code> in the <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">best/1/bin</span></code>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{v}_{i} = \mathbf{x}_{\text{best}} + F * (\mathbf{x}_a - \mathbf{x}_b)\]</div>
<p>Where all <span class="math notranslate nohighlight">\(a \neq b \neq i\)</span> as before and <span class="math notranslate nohighlight">\(\mathbf{x}_{\text{best}}\)</span> is the current best solution vector.</p>
<p>Here, we’ll observe the effect of the choice on the mean best objective value and standard deviation of the current DE stored parameter matrix (or population).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;best1bin&quot;</span><span class="p">,</span> <span class="s2">&quot;rand1bin&quot;</span><span class="p">]</span>
<span class="n">bests</span><span class="p">,</span> <span class="n">variances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">solve</span><span class="p">(</span><span class="n">strategy_</span><span class="o">=</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">]))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">bests</span><span class="p">,</span> <span class="n">variances</span><span class="p">,</span> <span class="n">strategies</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/05_examples_de_hyperparameters_6_0.png" src="../_images/05_examples_de_hyperparameters_6_0.png" />
</div>
</div>
<p>Its clear from the plots that the standard deviation of the current population decreases faster for <code class="docutils literal notranslate"><span class="pre">best/1/bin</span></code>. Consider the formula for this update rule. Using <span class="math notranslate nohighlight">\(\mathbf{x}_{\text{best}}\)</span> in the mutation strategy pulls new solutions toward the best solution along dimensions that make it into child vectors in the crossover step. Because of this, the search converges to an optimum faster. This is a double edged sword: one may obtain a solution faster but there is no guarantee that it
will be good. The strategy <code class="docutils literal notranslate"><span class="pre">rand/1/bin</span></code> shows more diversity from the standard deviation plot but converges more slowly.</p>
</div>
<div class="section" id="Effect-of-popsize">
<h2>Effect of <code class="docutils literal notranslate"><span class="pre">popsize</span></code><a class="headerlink" href="#Effect-of-popsize" title="Permalink to this headline">¶</a></h2>
<p>Population size is a more direct control on how diverse any one given DE population will be. In general, it is recommended to increase population size linearly with the dimension of the problem. There are many recommendations on how to do this, by default <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code> sets the population size to <span class="math notranslate nohighlight">\(n=15d\)</span> for a <span class="math notranslate nohighlight">\(d\)</span>-dimensional problem. Other recommendations have been made as low as <span class="math notranslate nohighlight">\(n=3d\)</span> for this parameter.</p>
<p>Practically speaking, population size is usually limited by computation. Any population based algorithm will begin to run slowly due to effort spent creating and evaluating new solutions as population size increases. A good rule of thumb is to pick a population size that balances convergence time and final objective value. Obviously we want the best possible objective, but not at the sacrifice of fast convergence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">popsizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">dimension</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="n">bests</span><span class="p">,</span> <span class="n">variances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">solve</span><span class="p">(</span><span class="n">popsize_</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">popsizes</span><span class="p">]))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">bests</span><span class="p">,</span> <span class="n">variances</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;$n=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">popsizes</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/05_examples_de_hyperparameters_9_0.png" src="../_images/05_examples_de_hyperparameters_9_0.png" />
</div>
</div>
<p>We can see here that, for the default values of <code class="docutils literal notranslate"><span class="pre">mutation</span></code> and <code class="docutils literal notranslate"><span class="pre">recombination</span></code>, population size stops making a big difference in convergence rate after <span class="math notranslate nohighlight">\(n=50\)</span>. Therefore, in this case, there’s no real reason to use a population size outside the range of <span class="math notranslate nohighlight">\(25\)</span> to <span class="math notranslate nohighlight">\(50\)</span>. The population size <span class="math notranslate nohighlight">\(n=5\)</span> (the lowest possible population size for <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code>) is clearly too small since the population converges quite slowly to a poor solution.</p>
</div>
<div class="section" id="Effect-of-mutation">
<h2>Effect of <code class="docutils literal notranslate"><span class="pre">mutation</span></code><a class="headerlink" href="#Effect-of-mutation" title="Permalink to this headline">¶</a></h2>
<p>Consider again the <code class="docutils literal notranslate"><span class="pre">rand/1/bin</span></code> strategy for mutation:</p>
<div class="math notranslate nohighlight">
\[\mathbf{v}_{i} = \mathbf{x}_a + F * (\mathbf{x}_b - \mathbf{x}_c)\]</div>
<p>Here, <span class="math notranslate nohighlight">\(F\)</span> is the mutation factor (has many names in literature). This hyperparameter can be thought of as the step size of DE. The original implementation of DE recommends <span class="math notranslate nohighlight">\(F\)</span> be in the range <span class="math notranslate nohighlight">\([0.4, 1]\)</span>. The implementation in <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code> also supports “dithering” which refers to choosing <span class="math notranslate nohighlight">\(F\)</span> from a uniform distribution each generation. In order to use this feature, simply supply a tuple of the form <span class="math notranslate nohighlight">\((F_{min}, F_{max})\)</span>. Dithering has been shown
to increase the reliability of DE convergence on some problems.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mutations</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">bests</span><span class="p">,</span> <span class="n">variances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">solve</span><span class="p">(</span><span class="n">mutation_</span><span class="o">=</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mutations</span><span class="p">]))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">bests</span><span class="p">,</span> <span class="n">variances</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;$F=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mutations</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/05_examples_de_hyperparameters_12_0.png" src="../_images/05_examples_de_hyperparameters_12_0.png" />
</div>
</div>
<p>For the smaller values of <span class="math notranslate nohighlight">\(F=0.1,0.25\)</span> convergence happens quite quickly to a non-optimal. From this we can infer that the algorithm is taking too small of steps. Conversely, for <span class="math notranslate nohighlight">\(F=1\)</span>, convergence is slowest, meaning that our algorithm is taking too large of steps for this mutation factor. <span class="math notranslate nohighlight">\(F=0.5\)</span> seems to be the just right value for this function in <span class="math notranslate nohighlight">\(\mathbb{R}^5\)</span>.</p>
</div>
<div class="section" id="Effect-of-recombination">
<h2>Effect of <code class="docutils literal notranslate"><span class="pre">recombination</span></code><a class="headerlink" href="#Effect-of-recombination" title="Permalink to this headline">¶</a></h2>
<p>The final hyperparameter to be tuned is the crossover rate, or <span class="math notranslate nohighlight">\(C_r\)</span> (called <code class="docutils literal notranslate"><span class="pre">recombination</span></code> in <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code>). To create a trial solution at index <span class="math notranslate nohighlight">\(i\)</span> with DE, indices are randomly chosen from the mutant vector, <span class="math notranslate nohighlight">\(\mathbf{v}_i\)</span> and the vector at index <span class="math notranslate nohighlight">\(i\)</span> in the current population (also called the parent population). More explicitly, the trial vector <span class="math notranslate nohighlight">\(\mathbf{u}_i\)</span> follows the following relation</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{u}_i = (u_{i,j}) = \begin{cases}
v_{i,j} &amp; \text{if} ~ r \leq C_r ~ \text{or} ~ j = j_{\text{rand}} \\
x_{i,j} &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(j_{rand}\)</span> is a random choice from the range <span class="math notranslate nohighlight">\([1, d]\)</span> for a <span class="math notranslate nohighlight">\(d\)</span>-dimensional problem and <span class="math notranslate nohighlight">\(0 &lt; r &lt; 1\)</span> is a uniform random number generated for each value of <span class="math notranslate nohighlight">\(j\)</span>. Clearly, <span class="math notranslate nohighlight">\(C_r\)</span> is a probability, so it must be in <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p>
<p>Small values of <span class="math notranslate nohighlight">\(C_r\)</span> cause too few number of parameters to be changed, causing the resulting vector to likely be a single step along one dimension. Larger values cause almost all of the mutant vector’s entries to be chosen, meaning possible good values for a particular dimension are less likely to be kept. It is recommended that <span class="math notranslate nohighlight">\(C_r \in [0.3, 0.9]\)</span>. By default, <code class="docutils literal notranslate"><span class="pre">DifferentialEvolutionSolver</span></code> sets <span class="math notranslate nohighlight">\(C_r = 0.7\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">crossovers</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">bests</span><span class="p">,</span> <span class="n">variances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">solve</span><span class="p">(</span><span class="n">recombination_</span><span class="o">=</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">crossovers</span><span class="p">]))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">bests</span><span class="p">,</span> <span class="n">variances</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;$C_r=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">crossovers</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/05_examples_de_hyperparameters_15_0.png" src="../_images/05_examples_de_hyperparameters_15_0.png" />
</div>
</div>
<p>The Ackley function is seperable, meaning that each of its dimensions can be optimized independently while still reaching an optimum. As a result, the crossover rate matters less for this problem. It still has a mild influence on convergence at extreme values, but anything in the acceptable range of <span class="math notranslate nohighlight">\([0.4, 0.9]\)</span> works fine in this case.</p>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Found a bug, or didn’t find what you were looking for? <a class="reference external" href="https://git.mckinsey-solutions.com/opm/optimus/issues/new/choose">🙏Please file a
issue</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../06_optimizer_api/modules.html" class="btn btn-neutral float-right" title="optimizer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="warm_start.html" class="btn btn-neutral float-left" title="Warm start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, QuantumBlack

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>